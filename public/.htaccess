# Enable URL rewriting
RewriteEngine On

# Redirect all requests to index.php (front controller pattern)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule (.*) index.php?$1 [L,QSA]

# Set index.php as the default file
DirectoryIndex index.php

# Prevent directory listing
Options -Indexes

# Set default character encoding
AddDefaultCharset UTF-8

# Protect sensitive files
<FilesMatch "\.(env|json|config|log|htaccess)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Improve caching for static assets
<FilesMatch "\.(css|js|jpg|jpeg|png|gif|ico|svg|webp)$">
    Header set Cache-Control "max-age=31536000, public"
</FilesMatch>

# Lock sensitive directories
RedirectMatch 403 ^/src/